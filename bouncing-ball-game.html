<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <title>[Case studio] Bouncing Ball Game</title>
     <style>
    body{
        background-color:black;
    }
     #myCanvas{
         border: 1px solid grey;
         margin-left: 500px;
         background: grey;
         border-radius: 5px;
     }
     .btn{
        margin-left: 600px;
        margin-top: 40px;
     }
     #score{
         font-family: 'Courier New', Courier, monospace;
         font-size: 40px;
         color :white;
         margin-top: -400px;
          margin-left: 200px;
     }
     </style>
</head>

<body>

    <div class="bg"><canvas id="myCanvas" width="400" height="500"></canvas></div>
    <input type="button" id="again" class="btn btn-info" value="Play again">
    <div id="score">Score: </div>

    <script>
        let mygame;
        let ball;
        let player;
        var score=0;

        window.onload = function () {
            mygame = new MyGame();
            ball = new Ball();
            player = new Player();
            mygame.init();

            document.getElementById("again").onclick = function () {
                location.reload();
            }
        }

        class MyGame {
            constructor() {
                this.canvas = document.getElementById("myCanvas");
                this.context = this.canvas.getContext("2d");
            }

            init() {
                this.intervalDrawMyGame = setInterval(updateMyGame, 40);
                document.addEventListener("mousemove", mouseMoveHandler, false);
            }

            clear() {
                this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
            }

            stop() {
                clearInterval(this.intervalDrawMyGame);
                this.clear();
                setTimeout(gameOver, 100);
            }
        }

        class Ball {
            constructor() {
                this.context = mygame.context;
                this.x = 100;
                this.y = 100;
                this.speedX = 5;
                this.speedY = 5;
                this.radius = 10;
            }

            drawBall() {
                this.context.beginPath();
                this.context.arc(this.x, this.y, this.radius, 0, 2 * Math.PI);
                this.context.fillStyle = "#000000";
                this.context.fill();
                this.context.stroke();
            }

            ballMove() {
                if (this.x < 0 || this.x > 401 - this.radius)
                    this.speedX = -this.speedX;
                if (this.y < 0) this.speedY = -this.speedY;
                if (this.y > 600) mygame.stop();
                this.x += this.speedX;
                this.y += this.speedY;
                if (score>10){
                    this.speedX +=2;
                    this.speedY +=2;
                }
            }
        }

        class Player {
            constructor() {
                this.context = mygame.context;
                this.x = 100;
                this.y = 480;
                this.width = 100;
                this.height = 20;
            }

            drawPlayer() {
                this.context.fillStyle = "blue";
                this.context.fillRect(this.x, this.y, this.width, this.height);
            }
        }
        
        function updateMyGame() {
            mygame.clear();
            ball.ballMove();
            ball.drawBall();
            if (ball.x + ball.radius >= player.x && ball.x <= player.x + player.width &&
                ball.y + ball.radius >= player.y && ball.y <= player.y + player.height) {
                ball.speedY = -ball.speedY;
                score++;
                document.getElementById("score").innerHTML="Score : " +score;
            }

            player.drawPlayer();

        }

        function mouseMoveHandler(e) {
            player.x = e.clientX - mygame.canvas.offsetLeft - player.width / 2;
        }

        function gameOver() {
            mygame.context.font = "40px Comic Sans MS";
            mygame.context.fillStyle = "red";
            mygame.context.textAlign = "center";
            mygame.context.fillText("Game Over", mygame.canvas.width / 2, mygame.canvas.height / 2);
        }

    </script>
</body>

</html>